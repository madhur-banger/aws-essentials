"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.componentRequiresDataApi = exports.formRequiresDataApi = void 0;
const dataActions = [
    'Amplify.DataStoreCreateItemAction',
    'Amplify.DataStoreUpdateItemAction',
    'Amplify.DataStoreDeleteItemAction',
];
function formRequiresDataApi(form) {
    return form.dataType.dataSourceType === 'DataStore';
}
exports.formRequiresDataApi = formRequiresDataApi;
function componentRequiresDataApi(component) {
    // data-bound collections have their data dependency persisted as a collection property
    if (component.componentType === 'Collection' && component.collectionProperties) {
        return Object.values(component.collectionProperties).length > 0;
    }
    // data-bound components need to be searched recursively for datastore actions
    return hasDataAction(component);
}
exports.componentRequiresDataApi = componentRequiresDataApi;
function isActionEvent(event) {
    return 'action' in event && !!event.action;
}
function hasDataAction(component) {
    const actions = Object.values(component.events || {})
        .filter(isActionEvent)
        .map((e) => e.action);
    if (actions.length && actions.some((a) => dataActions.includes(a))) {
        return true;
    }
    return (component.children || []).some(hasDataAction);
}
//# sourceMappingURL=data-binding-utils.js.map