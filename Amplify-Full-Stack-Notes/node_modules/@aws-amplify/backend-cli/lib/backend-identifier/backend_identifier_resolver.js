import { BackendIdentifierConversions } from '@aws-amplify/platform-core';
/**
 * Translates args to BackendIdentifier.
 * Throws if translation can't be made (this should never happen if command validation works correctly).
 */
export class AppBackendIdentifierResolver {
    namespaceResolver;
    /**
     * Instantiates BackendIdentifierResolver
     */
    constructor(namespaceResolver) {
        this.namespaceResolver = namespaceResolver;
    }
    resolveDeployedBackendIdentifier = async (args) => {
        if (args.stack) {
            return { stackName: args.stack };
        }
        else if (args.appId && args.branch) {
            return {
                namespace: args.appId,
                name: args.branch,
                type: 'branch',
            };
        }
        else if (args.branch) {
            return {
                appName: await this.namespaceResolver.resolve(),
                branchName: args.branch,
            };
        }
        return undefined;
    };
    resolveBackendIdentifier = async (args) => {
        if (args.stack) {
            return BackendIdentifierConversions.fromStackName(args.stack);
        }
        else if (args.appId && args.branch) {
            return {
                namespace: args.appId,
                name: args.branch,
                type: 'branch',
            };
        }
        else if (args.branch) {
            return {
                namespace: await this.namespaceResolver.resolve(),
                name: args.branch,
                type: 'branch',
            };
        }
        return undefined;
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFja2VuZF9pZGVudGlmaWVyX3Jlc29sdmVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL2JhY2tlbmQtaWRlbnRpZmllci9iYWNrZW5kX2lkZW50aWZpZXJfcmVzb2x2ZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBR0EsT0FBTyxFQUFFLDRCQUE0QixFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFpQjFFOzs7R0FHRztBQUNILE1BQU0sT0FBTyw0QkFBNEI7SUFJVjtJQUg3Qjs7T0FFRztJQUNILFlBQTZCLGlCQUFvQztRQUFwQyxzQkFBaUIsR0FBakIsaUJBQWlCLENBQW1CO0lBQUcsQ0FBQztJQUNyRSxnQ0FBZ0MsR0FBRyxLQUFLLEVBQ3RDLElBQWlDLEVBQ2UsRUFBRTtRQUNsRCxJQUFJLElBQUksQ0FBQyxLQUFLLEVBQUU7WUFDZCxPQUFPLEVBQUUsU0FBUyxFQUFFLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztTQUNsQzthQUFNLElBQUksSUFBSSxDQUFDLEtBQUssSUFBSSxJQUFJLENBQUMsTUFBTSxFQUFFO1lBQ3BDLE9BQU87Z0JBQ0wsU0FBUyxFQUFFLElBQUksQ0FBQyxLQUFLO2dCQUNyQixJQUFJLEVBQUUsSUFBSSxDQUFDLE1BQU07Z0JBQ2pCLElBQUksRUFBRSxRQUFRO2FBQ2YsQ0FBQztTQUNIO2FBQU0sSUFBSSxJQUFJLENBQUMsTUFBTSxFQUFFO1lBQ3RCLE9BQU87Z0JBQ0wsT0FBTyxFQUFFLE1BQU0sSUFBSSxDQUFDLGlCQUFpQixDQUFDLE9BQU8sRUFBRTtnQkFDL0MsVUFBVSxFQUFFLElBQUksQ0FBQyxNQUFNO2FBQ3hCLENBQUM7U0FDSDtRQUNELE9BQU8sU0FBUyxDQUFDO0lBQ25CLENBQUMsQ0FBQztJQUNGLHdCQUF3QixHQUFHLEtBQUssRUFDOUIsSUFBaUMsRUFDTyxFQUFFO1FBQzFDLElBQUksSUFBSSxDQUFDLEtBQUssRUFBRTtZQUNkLE9BQU8sNEJBQTRCLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztTQUMvRDthQUFNLElBQUksSUFBSSxDQUFDLEtBQUssSUFBSSxJQUFJLENBQUMsTUFBTSxFQUFFO1lBQ3BDLE9BQU87Z0JBQ0wsU0FBUyxFQUFFLElBQUksQ0FBQyxLQUFLO2dCQUNyQixJQUFJLEVBQUUsSUFBSSxDQUFDLE1BQU07Z0JBQ2pCLElBQUksRUFBRSxRQUFRO2FBQ2YsQ0FBQztTQUNIO2FBQU0sSUFBSSxJQUFJLENBQUMsTUFBTSxFQUFFO1lBQ3RCLE9BQU87Z0JBQ0wsU0FBUyxFQUFFLE1BQU0sSUFBSSxDQUFDLGlCQUFpQixDQUFDLE9BQU8sRUFBRTtnQkFDakQsSUFBSSxFQUFFLElBQUksQ0FBQyxNQUFNO2dCQUNqQixJQUFJLEVBQUUsUUFBUTthQUNmLENBQUM7U0FDSDtRQUVELE9BQU8sU0FBUyxDQUFDO0lBQ25CLENBQUMsQ0FBQztDQUNIIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRGVwbG95ZWRCYWNrZW5kSWRlbnRpZmllciB9IGZyb20gJ0Bhd3MtYW1wbGlmeS9kZXBsb3llZC1iYWNrZW5kLWNsaWVudCc7XG5pbXBvcnQgeyBOYW1lc3BhY2VSZXNvbHZlciB9IGZyb20gJy4vbG9jYWxfbmFtZXNwYWNlX3Jlc29sdmVyLmpzJztcbmltcG9ydCB7IEJhY2tlbmRJZGVudGlmaWVyIH0gZnJvbSAnQGF3cy1hbXBsaWZ5L3BsdWdpbi10eXBlcyc7XG5pbXBvcnQgeyBCYWNrZW5kSWRlbnRpZmllckNvbnZlcnNpb25zIH0gZnJvbSAnQGF3cy1hbXBsaWZ5L3BsYXRmb3JtLWNvcmUnO1xuXG5leHBvcnQgdHlwZSBCYWNrZW5kSWRlbnRpZmllclBhcmFtZXRlcnMgPSB7XG4gIHN0YWNrPzogc3RyaW5nO1xuICBhcHBJZD86IHN0cmluZztcbiAgYnJhbmNoPzogc3RyaW5nO1xufTtcblxuZXhwb3J0IHR5cGUgQmFja2VuZElkZW50aWZpZXJSZXNvbHZlciA9IHtcbiAgcmVzb2x2ZURlcGxveWVkQmFja2VuZElkZW50aWZpZXI6IChcbiAgICBhcmdzOiBCYWNrZW5kSWRlbnRpZmllclBhcmFtZXRlcnNcbiAgKSA9PiBQcm9taXNlPERlcGxveWVkQmFja2VuZElkZW50aWZpZXIgfCB1bmRlZmluZWQ+O1xuICByZXNvbHZlQmFja2VuZElkZW50aWZpZXI6IChcbiAgICBhcmdzOiBCYWNrZW5kSWRlbnRpZmllclBhcmFtZXRlcnNcbiAgKSA9PiBQcm9taXNlPEJhY2tlbmRJZGVudGlmaWVyIHwgdW5kZWZpbmVkPjtcbn07XG5cbi8qKlxuICogVHJhbnNsYXRlcyBhcmdzIHRvIEJhY2tlbmRJZGVudGlmaWVyLlxuICogVGhyb3dzIGlmIHRyYW5zbGF0aW9uIGNhbid0IGJlIG1hZGUgKHRoaXMgc2hvdWxkIG5ldmVyIGhhcHBlbiBpZiBjb21tYW5kIHZhbGlkYXRpb24gd29ya3MgY29ycmVjdGx5KS5cbiAqL1xuZXhwb3J0IGNsYXNzIEFwcEJhY2tlbmRJZGVudGlmaWVyUmVzb2x2ZXIgaW1wbGVtZW50cyBCYWNrZW5kSWRlbnRpZmllclJlc29sdmVyIHtcbiAgLyoqXG4gICAqIEluc3RhbnRpYXRlcyBCYWNrZW5kSWRlbnRpZmllclJlc29sdmVyXG4gICAqL1xuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHJlYWRvbmx5IG5hbWVzcGFjZVJlc29sdmVyOiBOYW1lc3BhY2VSZXNvbHZlcikge31cbiAgcmVzb2x2ZURlcGxveWVkQmFja2VuZElkZW50aWZpZXIgPSBhc3luYyAoXG4gICAgYXJnczogQmFja2VuZElkZW50aWZpZXJQYXJhbWV0ZXJzXG4gICk6IFByb21pc2U8RGVwbG95ZWRCYWNrZW5kSWRlbnRpZmllciB8IHVuZGVmaW5lZD4gPT4ge1xuICAgIGlmIChhcmdzLnN0YWNrKSB7XG4gICAgICByZXR1cm4geyBzdGFja05hbWU6IGFyZ3Muc3RhY2sgfTtcbiAgICB9IGVsc2UgaWYgKGFyZ3MuYXBwSWQgJiYgYXJncy5icmFuY2gpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG5hbWVzcGFjZTogYXJncy5hcHBJZCxcbiAgICAgICAgbmFtZTogYXJncy5icmFuY2gsXG4gICAgICAgIHR5cGU6ICdicmFuY2gnLFxuICAgICAgfTtcbiAgICB9IGVsc2UgaWYgKGFyZ3MuYnJhbmNoKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBhcHBOYW1lOiBhd2FpdCB0aGlzLm5hbWVzcGFjZVJlc29sdmVyLnJlc29sdmUoKSxcbiAgICAgICAgYnJhbmNoTmFtZTogYXJncy5icmFuY2gsXG4gICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9O1xuICByZXNvbHZlQmFja2VuZElkZW50aWZpZXIgPSBhc3luYyAoXG4gICAgYXJnczogQmFja2VuZElkZW50aWZpZXJQYXJhbWV0ZXJzXG4gICk6IFByb21pc2U8QmFja2VuZElkZW50aWZpZXIgfCB1bmRlZmluZWQ+ID0+IHtcbiAgICBpZiAoYXJncy5zdGFjaykge1xuICAgICAgcmV0dXJuIEJhY2tlbmRJZGVudGlmaWVyQ29udmVyc2lvbnMuZnJvbVN0YWNrTmFtZShhcmdzLnN0YWNrKTtcbiAgICB9IGVsc2UgaWYgKGFyZ3MuYXBwSWQgJiYgYXJncy5icmFuY2gpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG5hbWVzcGFjZTogYXJncy5hcHBJZCxcbiAgICAgICAgbmFtZTogYXJncy5icmFuY2gsXG4gICAgICAgIHR5cGU6ICdicmFuY2gnLFxuICAgICAgfTtcbiAgICB9IGVsc2UgaWYgKGFyZ3MuYnJhbmNoKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBuYW1lc3BhY2U6IGF3YWl0IHRoaXMubmFtZXNwYWNlUmVzb2x2ZXIucmVzb2x2ZSgpLFxuICAgICAgICBuYW1lOiBhcmdzLmJyYW5jaCxcbiAgICAgICAgdHlwZTogJ2JyYW5jaCcsXG4gICAgICB9O1xuICAgIH1cblxuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH07XG59XG4iXX0=